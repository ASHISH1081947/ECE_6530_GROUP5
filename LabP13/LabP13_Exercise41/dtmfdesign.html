
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Simple Bandpass Filter Design: dtmfdesign.m</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-12-08"><meta name="DC.source" content="dtmfdesign.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Simple Bandpass Filter Design: dtmfdesign.m</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">4.1a)</a></li><li><a href="#2">4.1b)</a></li><li><a href="#4">4.1c)</a></li><li><a href="#5">4.1d)</a></li><li><a href="#6">4.1e)</a></li><li><a href="#7">4.1f) DONE - HELP Section</a></li></ul></div><h2 id="1">4.1a)</h2><p>For this one, we decided to use the mathematical description to calculate beta and then multiplied it accross to get the value of the hh column vector.</p><h2 id="2">4.1b)</h2><pre class="codeinput"><span class="keyword">function</span> hh = dtmfdesign(fb, L, fs)
</pre><pre class="codeinput"><span class="comment">% DTMFDESIGN</span>
<span class="comment">% hh = dtmfdesign(fb, L, fs)</span>
<span class="comment">% returns a matrix (L by length(fb)) where each column contains</span>
<span class="comment">% the impulse response of a BPF, one for each frequency in fb</span>
<span class="comment">% fb = vector of center frequencies</span>
<span class="comment">% L = length of FIR bandpass filters</span>
<span class="comment">% fs = sampling freq</span>
<span class="comment">%</span>
<span class="comment">% Each BPF must be scaled so that its frequency response has a</span>
<span class="comment">% maximum magnitude equal to one.</span>

n = 0:L; <span class="comment">% Set value of sample points</span>
omega = 0:pi/300:pi; <span class="comment">% Set value of omega with pi/300 steps</span>
<span class="keyword">for</span> i = 1:length(fb)
    <span class="comment">% Design simple bandpass filter</span>
    hb(i,:) = cos((2*pi*fb(i)*n)/fs);

    <span class="comment">% Beta calculation for gain scaling</span>
    beta(i,:) = abs(1/(max(freqz(hb(i,:),1,omega))));

    <span class="comment">% scale each filter to finish</span>
    h(i,:) = hb(i,:)*beta(i,:);
<span class="keyword">end</span>
<span class="comment">% Transpose the vector into a column vector</span>
hh = h';
</pre><pre class="codeoutput error">Not enough input arguments.

Error in dtmfdesign (line 20)
n = 0:L; % Set value of sample points
</pre><h2 id="4">4.1c)</h2><p>DONE - ADDITIONAL INFO FOR PART D) F) We justify the legth of the filters based on the width of the passband we want to pass in relation to the width and amplitude of the side lobes. As the length of the filter increases, the width of the passband decreases and we want to strike a balance between having efficient code and passing appropariate frequencies without skipping parts of an individual frequency.</p><h2 id="5">4.1d)</h2><p>Define DTMF frequencies</p><pre class="codeinput">dtmf_frequencies = [697, 770, 852, 941, 1209, 1336, 1477, 1633];
<span class="comment">% Parameters</span>
L = 40;
fs = 8000;

<span class="comment">% Generate bandpass filters</span>
hh = dtmfdesign(dtmf_frequencies, L, fs);

<span class="comment">% Plot frequency responses</span>
figure;
hold <span class="string">on</span>;

<span class="keyword">for</span> i = 1:size(hh, 2)
    <span class="comment">% Frequency response of the i-th filter</span>
    H = freqz(hh(:, i), 1, <span class="string">'half'</span>, fs);

    <span class="comment">% Plot magnitude response</span>
    plot(linspace(0, pi, length(H)), abs(H), <span class="string">'LineWidth'</span>, 1.5);
<span class="keyword">end</span>

hold <span class="string">off</span>;

title(<span class="string">'Magnitude Response of Scaled DTMF Bandpass Filters'</span>);
xlabel(<span class="string">'Normalized Frequency (\omega / \pi)'</span>);
ylabel(<span class="string">'Magnitude'</span>);
legend(<span class="string">'697 Hz'</span>, <span class="string">'770 Hz'</span>, <span class="string">'852 Hz'</span>, <span class="string">'941 Hz'</span>, <span class="string">'1209 Hz'</span>, <span class="string">'1336 Hz'</span>, <span class="string">'1477 Hz'</span>, <span class="string">'1633 Hz'</span>, <span class="string">'Location'</span>, <span class="string">'best'</span>);
grid <span class="string">on</span>;
</pre><h2 id="6">4.1e)</h2><p>Define DTMF frequencies</p><pre class="codeinput">dtmf_freqs = [697, 770, 852, 941, 1209, 1336, 1477, 1633];
<span class="comment">% Parameters</span>
L = 40;
fs = 8000;

<span class="comment">% Generate bandpass filters</span>
hh = dtmfdesign(dtmf_freqs, L, fs);

<span class="comment">% Plot frequency responses</span>
figure;
hold <span class="string">on</span>;

<span class="keyword">for</span> i = 1:size(hh, 2)
    <span class="comment">% Frequency response of the i-th filter</span>
    H = freqz(hh(:, i), 1, <span class="string">'half'</span>, fs);

    <span class="comment">% Plot magnitude response</span>
    plot(linspace(0, pi, length(H)), abs(H), <span class="string">'LineWidth'</span>, 1.5);
<span class="keyword">end</span>

hold <span class="string">off</span>;

title(<span class="string">'Magnitude Response of Scaled DTMF Bandpass Filters'</span>);
xlabel(<span class="string">'Normalized Frequency (\omega / \pi)'</span>);
ylabel(<span class="string">'Magnitude'</span>);
legend(<span class="string">'697 Hz'</span>, <span class="string">'770 Hz'</span>, <span class="string">'852 Hz'</span>, <span class="string">'941 Hz'</span>, <span class="string">'1209 Hz'</span>, <span class="string">'1336 Hz'</span>, <span class="string">'1477 Hz'</span>, <span class="string">'1633 Hz'</span>, <span class="string">'Location'</span>, <span class="string">'best'</span>);
grid <span class="string">on</span>;
</pre><h2 id="7">4.1f) DONE - HELP Section</h2><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%%  Simple Bandpass Filter Design: dtmfdesign.m

%% 4.1a)
% For this one, we decided to use the mathematical description to calculate
% beta and then multiplied it accross to get the value of the hh column
% vector.
%% 4.1b)
function hh = dtmfdesign(fb, L, fs)
% DTMFDESIGN
% hh = dtmfdesign(fb, L, fs)
% returns a matrix (L by length(fb)) where each column contains
% the impulse response of a BPF, one for each frequency in fb
% fb = vector of center frequencies
% L = length of FIR bandpass filters
% fs = sampling freq
%
% Each BPF must be scaled so that its frequency response has a
% maximum magnitude equal to one.

n = 0:L; % Set value of sample points
omega = 0:pi/300:pi; % Set value of omega with pi/300 steps
for i = 1:length(fb)
    % Design simple bandpass filter
    hb(i,:) = cos((2*pi*fb(i)*n)/fs);

    % Beta calculation for gain scaling
    beta(i,:) = abs(1/(max(freqz(hb(i,:),1,omega)))); 

    % scale each filter to finish
    h(i,:) = hb(i,:)*beta(i,:);
end
% Transpose the vector into a column vector
hh = h';
%% 4.1c)
% DONE - ADDITIONAL INFO FOR PART D) F)
% We justify the legth of the filters based on the width of the passband we
% want to pass in relation to the width and amplitude of the side lobes.
% As the length of the filter increases, the width of the passband
% decreases and we want to strike a balance between having efficient code
% and passing appropariate frequencies without skipping parts of an
% individual frequency.
%% 4.1d)
% Define DTMF frequencies
dtmf_frequencies = [697, 770, 852, 941, 1209, 1336, 1477, 1633];
% Parameters
L = 40;
fs = 8000;

% Generate bandpass filters
hh = dtmfdesign(dtmf_frequencies, L, fs);

% Plot frequency responses
figure;
hold on;

for i = 1:size(hh, 2)
    % Frequency response of the i-th filter
    H = freqz(hh(:, i), 1, 'half', fs);

    % Plot magnitude response
    plot(linspace(0, pi, length(H)), abs(H), 'LineWidth', 1.5);
end

hold off;

title('Magnitude Response of Scaled DTMF Bandpass Filters');
xlabel('Normalized Frequency (\omega / \pi)');
ylabel('Magnitude');
legend('697 Hz', '770 Hz', '852 Hz', '941 Hz', '1209 Hz', '1336 Hz', '1477 Hz', '1633 Hz', 'Location', 'best');
grid on;
%% 4.1e) 
% Define DTMF frequencies
dtmf_freqs = [697, 770, 852, 941, 1209, 1336, 1477, 1633];
% Parameters
L = 40;
fs = 8000;

% Generate bandpass filters
hh = dtmfdesign(dtmf_freqs, L, fs);

% Plot frequency responses
figure;
hold on;

for i = 1:size(hh, 2)
    % Frequency response of the i-th filter
    H = freqz(hh(:, i), 1, 'half', fs);

    % Plot magnitude response
    plot(linspace(0, pi, length(H)), abs(H), 'LineWidth', 1.5);
end

hold off;

title('Magnitude Response of Scaled DTMF Bandpass Filters');
xlabel('Normalized Frequency (\omega / \pi)');
ylabel('Magnitude');
legend('697 Hz', '770 Hz', '852 Hz', '941 Hz', '1209 Hz', '1336 Hz', '1477 Hz', '1633 Hz', 'Location', 'best');
grid on;
%% 4.1f) DONE - HELP Section
##### SOURCE END #####
--></body></html>